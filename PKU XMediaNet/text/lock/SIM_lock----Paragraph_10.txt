The unlock code is verified by the handset and is generated by the manufacturer, typically by an algorithm such as a one way hash or trapdoor function. Sometimes big telecom providers change the original factory unlock codes as an extra layer of security against unlocking services. For various big brands such as Samsung and Motorola there is no algorithm but just a random code generator where the unlock codes are programmed in the phone itself and then saved in a big database managed by the manufacturer. For the other brands where the unlock codes are still based on algorithms those are based on the IMEI number and the MCC code and have been reverse-engineered, stolen or leaked. Some handsets can be unlocked using software that generates an unlock code from an IMEI number and country and operator details using the algorithm specific to the handset. Other manufacturers have taken a more cautious approach, and embed a random number in the handset's firmware that is retained by the network on whose behalf the lock was applied and the manufacturer. These handsets can still be unlocked by online services that have access to either inside people with the manufacturer or with the telecom networks, or they need to be connected to the computer with a cable where specific software will bypass the security and SIM-unlock the phone. Sometimes this is done by advanced calculations to bypass the security the official way and other times using exploits or overwriting parts of the firmware where the lock status is kept, and often even recover a phone that is bricked or completely damaged in the software sense.